
|Model                                                                   |PW* with fixes|PW no fixes|PW diff|Sing** with fixes|Sing no fixes|sing diff|PW diff == sing diff|
|---                                                                     |---|---|---|---|---|---|---|
|aslanidi_atrial_model_2009                                              |6  |6  |0  |6  |6  |0  |True |
|aslanidi_2009                                                           |4  |4  |0  |9  |9  |0  |True |
|beeler_reuter_model_1977                                                |2  |0  |2  |0  |2  |2  |True |
|benson_epicardial_2008                                                  |7  |7  |0  |9  |9  |0  |True |
|bernus_wilders_zemlin_verschelde_panfilov_ 2002_version01               |0  |0  |0  |1  |1  |0  |True |
|bondarenko_2004_apical                                                  |0  |0  |0  |1  |1  |0  |True |
|bondarenko_2004_septum                                                  |0  |0  |0  |1  |1  |0  |True |
|bueno_2007 (bueno_2007_endo.cellml)                                     |5  |5  |0  |0  |0  |0  |True |
|bueno_2007 (bueno_2007_epi.cellml)                                      |5  |5  |0  |0  |0  |0  |True |
|Carro_Rodriguez_Laguna_Pueyo_CinC2010_EPI (carro_2011_endo.cellml)      |4  |4  |0  |5  |5  |0  |True |
|Carro_Rodriguez_Laguna_Pueyo_CinC2010_EPI (carro_2011_epi.cellml)       |4  |4  |0  |5  |5  |0  |True |
|clancy_rudy_2002                                                        |10  |9  |1  |7  |8  |1  |True |
|Corrias_rabbit_purkinje_model                                           |3  |0  |3  |0  |4  |4  |False |
|courtemanche_1998                                                       |11  |4  |7  |0  |7  |7  |True |
|davies_isap_2012                                                        |12  |5  |7  |0  |7  |7  |True |
|decker_2009                                                             |12  |4  |8  |0  |8  |8  |True |
|demir_model_1994                                                        |0  |0  |0  |6  |6  |0  |True |
|difrancesco_noble_model_1985                                            |5  |0  |5  |5  |10  |5  |True |
|dokos_model_1996                                                        |0  |0  |0  |3  |3  |0  |True |
|earm_noble_model_1990                                                   |4  |4  |0  |3  |3  |0  |True |
|espinosa_model_1998                                                     |7  |1  |6  |3  |9  |6  |True |
|faber_rudy_2000                                                         |15  |13  |2  |11  |13  |2  |True |
|fink_noble_giles_model_2008                                             |4  |4  |0  |1  |1  |0  |True |
|fox_model_2001                                                          |0  |0  |0  |5  |5  |0  |True |
|grandi_pasqualini_bers_2010 (grandi_pasqualini_bers_2010_ss.cellml)     |6  |6  |0  |6  |6  |0  |True |
|grandi_pasqualini_bers_2010 (grandi_pasqualini_bers_2010_ss_endo.cellml)|6  |6  |0  |6  |6  |0  |True |
|hilgemann_noble_model_1987                                              |4  |0  |4  |3  |7  |4  |True |
|hodgkin_huxley_squid_axon_model_1952_ modified                          |2  |0  |2  |0  |2  |2  |True |
|HundRudy2004_units                                                      |7  |7  |0  |9  |9  |0  |True |
|iribe_model_2006                                                        |5  |1  |4  |3  |7  |4  |True |
|IyerMazhariWinslow2004                                                  |1  |1  |0  |4  |4  |0  |True |
|iyer_model_2007                                                         |7  |7  |0  |4  |4  |0  |True |
|jafri_rice_winslow_1998                                                 |4  |4  |0  |5  |5  |0  |True |
|kurata_model_2002                                                       |0  |0  |0  |3  |3  |0  |True |
|lindblad_atrial_model_1996                                              |0  |0  |0  |6  |6  |0  |True |
|LivshitzRudy2007                                                        |0  |0  |0  |9  |9  |0  |True |
|Li_Mouse_2010                                                           |3  |2  |1  |1  |2  |1  |True |
|luo_rudy_1991                                                           |7  |5  |2  |0  |2  |2  |True |
|luo_rudy_1994                                                           |5  |5  |0  |7  |7  |0  |True |
|MahajanShiferaw2008_units                                               |10  |5  |5  |0  |6  |6  |False |
|Maleckar                                                                |0  |0  |0  |1  |1  |0  |True |
|maltsev_2009                                                            |2  |0  |2  |0  |3  |3  |False |
|matsuoka_model_2003                                                     |4  |0  |4  |0  |4  |4  |True |
|mcallister_noble_tsien_1975_modelB                                      |0  |0  |0  |5  |5  |0  |True |
|noble_model_1962                                                        |0  |0  |0  |3  |3  |0  |True |
|noble_model_1991                                                        |4  |0  |4  |3  |7  |4  |True |
|noble_model_1998                                                        |5  |1  |4  |3  |7  |4  |True |
|noble_model_2001                                                        |5  |1  |4  |6  |10  |4  |True |
|NN_SAN_model_1984                                                       |7  |0  |7  |4  |11  |7  |True |
|Noble_SAN_model_1989                                                    |4  |0  |4  |4  |8  |4  |True |
|nygren_atrial_model_1998                                                |0  |0  |0  |1  |1  |0  |True |
|ohara_rudy_2011_endo                                                    |16  |16  |0  |5  |5  |0  |True |
|ohara_rudy_2011_epi                                                     |16  |16  |0  |5  |5  |0  |True |
|ohara_rudy_cipa_v1_2017                                                 |21  |16  |5  |0  |5  |5  |True |
|paci_hyttinen_aaltosetala_severi_atrial Version                         |9  |9  |0  |1  |1  |0  |True |
|paci_hyttinen_aaltosetala_severi_ventricular Version                    |13  |13  |0  |1  |1  |0  |True |
|pandit_clark_giles_demir_2001_ version06_variant01                      |2  |2  |0  |1  |1  |0  |True |
|pandit_clark_giles_demir_2001                                           |2  |2  |0  |1  |1  |0  |True |
|pasek_simurda_christe_2006                                              |0  |0  |0  |3  |3  |0  |True |
|pasek_model_2008                                                        |0  |0  |0  |8  |8  |0  |True |
|priebe_beuckelmann_1998                                                 |21  |20  |1  |0  |1  |1  |True |
|ramirez_2000                                                            |4  |4  |0  |6  |6  |0  |True |
|sachse_model_2007                                                       |0  |0  |0  |1  |1  |0  |True |
|sakmann_model_2000_epi                                                  |5  |1  |4  |7  |11  |4  |True |
|shannon_wang_puglisi_weber_bers_2004_model_ updated                     |4  |4  |0  |11  |11  |0  |True |
|stewart_zhang_model_2008                                                |4  |4  |0  |1  |1  |0  |True |
|tentusscher_model_2004_endo                                             |7  |7  |0  |1  |1  |0  |True |
|tentusscher_model_2004_epi                                              |8  |7  |1  |0  |1  |1  |True |
|tentusscher_model_2004_M                                                |7  |7  |0  |1  |1  |0  |True |
|tentusscher_model_2006_endo                                             |5  |4  |1  |0  |1  |1  |True |
|tentusscher_model_2006_epi                                              |5  |4  |1  |0  |1  |1  |True |
|tentusscher_model_2006_M                                                |5  |4  |1  |0  |1  |1  |True |
|Tomek_model13endo                                                       |21  |21  |0  |8  |8  |0  |True |
|Tomek_model13epi                                                        |21  |21  |0  |8  |8  |0  |True |
|Trovato2020                                                             |2  |2  |0  |5  |5  |0  |True |
|viswanathan_model_1999_epi                                              |15  |13  |2  |9  |11  |2  |True |
|wang_model_2008                                                         |4  |4  |0  |3  |3  |0  |True |
|winslow_model_1999                                                      |6  |5  |1  |4  |5  |1  |True |
|zhang_SAN_model_2000_0D_capable                                         |0  |0  |0  |4  |4  |0  |True |


*  PW = Number os Piecewise (in the set of derivative equations, secluding state variables and parameters)

** Sing = Number of (equation swith) singularities

# Model: Corrias_rabbit_purkinje_model(corrias_purkinje_2011.cellml)
- Identifies the singularity (-30.0) twice but with a different U and V range for both parts (A + B) of the equation. The nested piecewise generated is a bit ugly. 
- The formula the code uses is as follows (the condition is at the end: `singularity_piecewise_parts = [(f(vs) + ((V - vs) / (ve - vs)) * (f(ve) - f(vs)), Abs(V-sp) < Abs((ve-vs)/2))]`
- f(x) is the original formula with V replaces by x_ks__tau_x_ks
- ve & vs are U solved for -1e-7 and 1e-7
    - *U*: 2.0609999999999999 + 0.068699999999999997 * membrane__Vm
        - *V for 1e-07 range* `-30.000001455604075 - -29.999998544395925`
        - singularity point: -30.000000000000000
    - *U*: -4.4399999999999995 - 0.14799999999999999 * membrane__Vm
        - *V for 1e-07 range* `-29.999999324324325 - -30.000000675675675`
        - singularity point: -30.000000000000000
```
x_ks__tau_x_ks = 1 / (0.00013100000000000001 * (30.0 + membrane__Vm) / (-1.0 + 7.8538197044216602 * exp(0.068699999999999997 * membrane__Vm)) + 7.1899999999999999e-5 * (30.0 + membrane__Vm) / (1.0 - 0.011795938519751569 * exp(-0.14799999999999999 * membrane__Vm)))
```
## New Eq:
```
x_ks__tau_x_ks = ((fabs(30.0 + membrane__Vm) < 1.455604075689676e-6) ? (572.83278764737304 + 5.1628844994572827 * membrane__Vm) : ((fabs(30.0 + membrane__Vm) < 6.7567567568760367e-7) ? (572.77257882806907 + 5.160877538707906 * membrane__Vm) : (1 / (0.00013100000000000001 * (30.0 + membrane__Vm) / (-1.0 + exp(2.0609999999999999 + 0.068699999999999997 * membrane__Vm)) + 7.1899999999999999e-5 * (30.0 + membrane__Vm) / (1.0 - exp(-4.4399999999999995 - 0.14799999999999999 * membrane__Vm))))))
```


# Model: MahajanShiferaw2008_units
- Same issue as above:
        - *U: 2.0609999999999999 + 0.068699999999999997 * cell__V
            - *V for 1e-07 range*  `-30.000001455604075 - -29.999998544395925`
            - singularity point: -30.000000000000000
        -*U*: -4.4399999999999995 - 0.14799999999999999 * cell__V
            -*V for 1e-07 range* `-29.999999324324325 - -30.000000675675675`
            - singularity point: -30.000000000000000
```
IKs__tauxs1 = 1 / (0.00013100000000000001 * (30.0 + cell__V) / (-1.0 + 7.8538197044216602 * exp(0.068699999999999997 * cell__V)) + 7.1899999999999999e-5 * (30.0 + cell__V) / (1.0 - 0.011795938519751569 * exp(-0.14799999999999999 * cell__V)))
```
## New Eq:
```
IKs__tauxs1 = ((fabs(30.0 + cell__V) < 1.455604075689676e-6) ? (572.83278764737304 + 5.1628844994572827 * cell__V) : ((fabs(30.0 + cell__V) < 6.7567567568760367e-7) ? (572.77257882806907 + 5.160877538707906 * cell__V) : (1 / (0.00013100000000000001 * (30.0 + cell__V) / (-1.0 + exp(2.0609999999999999 + 0.068699999999999997 * cell__V)) + 7.1899999999999999e-5 * (30.0 + cell__V) / (1.0 - exp(-4.4399999999999995 - 0.14799999999999999 * cell__V))))))
```


# Model: maltsev_2009
- Same issue as above:
    - *U*: -14.0 - 0.40000000000000002 * Vm__Vm
        - *V for 1e-07 range* `-34.999999750000001 - -35.000000249999999`
        - singularity point: -35.000000000000000
    - *U*: -0.20833333333333334 * Vm__Vm
        - *V for 1e-07 range* `4.7999999999999996e-7 - -4.7999999999999996e-7`
        - singularity point: 0
```
i_CaL_dL_gate__alpha_dL = -0.028389999999999999 * (35.0 + Vm__Vm) / (-1.0 + exp(-14.0 - 0.40000000000000002 * Vm__Vm)) - 0.084900000000000003 * Vm__Vm / (-1.0 + exp(-0.20833333333333334 * Vm__Vm))
```
## New Eq:
```
i_CaL_dL_gate__alpha_dL = ((fabs(35.0 + Vm__Vm) < 2.5000000000718892e-7) ? (0.58229457863580991 + 0.014551258213141278 * Vm__Vm) : ((fabs(Vm__Vm) < 4.7999999999999996e-7) ? (1.4011708262480853 + 0.070842583268076562 * Vm__Vm) : (-0.028389999999999999 * (35.0 + Vm__Vm) / (-1.0 + exp(-14.0 - 0.40000000000000002 * Vm__Vm)) - 0.084900000000000003 * Vm__Vm / (-1.0 + exp(-0.20833333333333334 * Vm__Vm)))))
```
